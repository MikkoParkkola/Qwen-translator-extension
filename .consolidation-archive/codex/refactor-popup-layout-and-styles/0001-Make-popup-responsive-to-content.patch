From 01adeb8e786b982b2cdf773a4984e810cd2aa962 Mon Sep 17 00:00:00 2001
From: MikkoParkkola <78788115+MikkoParkkola@users.noreply.github.com>
Date: Tue, 19 Aug 2025 18:17:08 +0200
Subject: [PATCH] Make popup responsive to content

---
 package-lock.json       |  4 ++--
 package.json            |  2 +-
 src/popup.css           | 52 +++++++++++++++++++++++++++++++++++++++++
 src/popup.html          | 29 +----------------------
 src/popup/home.html     |  3 +++
 src/popup/settings.html |  8 +++++--
 updates.xml             |  2 +-
 7 files changed, 66 insertions(+), 34 deletions(-)
 create mode 100644 src/popup.css

diff --git a/package-lock.json b/package-lock.json
index 0f1050f..ce0738a 100644
--- a/package-lock.json
+++ b/package-lock.json
@@ -1,12 +1,12 @@
 {
   "name": "qwen-translator-extension",
-  "version": "1.41.0",
+  "version": "1.42.0",
   "lockfileVersion": 3,
   "requires": true,
   "packages": {
     "": {
       "name": "qwen-translator-extension",
-      "version": "1.41.0",
+      "version": "1.42.0",
       "hasInstallScript": true,
       "license": "AGPL-3.0-or-later",
       "dependencies": {
diff --git a/package.json b/package.json
index 592df65..2345369 100644
--- a/package.json
+++ b/package.json
@@ -1,6 +1,6 @@
 {
   "name": "qwen-translator-extension",
-  "version": "1.41.0",
+  "version": "1.42.0",
   "description": "Extension to translate web pages using Qwen-MT-Turbo model",
   "main": "index.js",
   "scripts": {
diff --git a/src/popup.css b/src/popup.css
new file mode 100644
index 0000000..43135b3
--- /dev/null
+++ b/src/popup.css
@@ -0,0 +1,52 @@
+html {
+  background: var(--qwen-bg, rgba(28,28,30,0.7));
+}
+body {
+  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
+  color: var(--qwen-text, #f5f5f7);
+  margin: 0;
+  display: flex;
+  flex-direction: column;
+  min-width: 260px;
+  max-width: 600px;
+  font-size: 1rem;
+}
+#nav {
+  display: flex;
+  justify-content: flex-end;
+  padding: 0.5rem;
+}
+#nav button {
+  background: none;
+  border: none;
+  color: inherit;
+  cursor: pointer;
+  font-size: 1.25rem;
+}
+#content {
+  border: 0;
+  display: block;
+  flex: 1 1 auto;
+}
+@media (max-width: 319px) {
+  body {
+    font-size: 0.875rem;
+  }
+  #nav {
+    padding: 0.25rem;
+  }
+  #nav button {
+    font-size: 1rem;
+  }
+}
+@media (min-width: 480px) {
+  body {
+    font-size: 1.125rem;
+  }
+  #nav {
+    padding: 0.75rem;
+  }
+  #nav button {
+    font-size: 1.5rem;
+  }
+}
diff --git a/src/popup.html b/src/popup.html
index 2bfca63..fde0d5a 100644
--- a/src/popup.html
+++ b/src/popup.html
@@ -3,34 +3,7 @@
 <head>
   <meta charset="utf-8">
   <link rel="stylesheet" href="styles/apple.css">
-  <style>
-    html {
-      background: var(--qwen-bg, rgba(28,28,30,0.7));
-    }
-    body {
-      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
-      color: var(--qwen-text, #f5f5f7);
-      margin: 0;
-      width: 300px; /* default width until iframe resizes */
-    }
-    #nav {
-      display: flex;
-      justify-content: flex-end;
-      padding: 0.5rem;
-    }
-    #nav button {
-      background: none;
-      border: none;
-      color: inherit;
-      cursor: pointer;
-      font-size: 1.25rem;
-    }
-    #content {
-      width: 100%;
-      border: 0;
-      display: block;
-    }
-  </style>
+  <link rel="stylesheet" href="popup.css">
 </head>
 <body>
   <header id="nav">
diff --git a/src/popup/home.html b/src/popup/home.html
index a0899fe..2794d2f 100644
--- a/src/popup/home.html
+++ b/src/popup/home.html
@@ -6,6 +6,7 @@
   <link rel="stylesheet" href="../styles/cyberpunk.css">
   <style>
     html {
+      height: 100%;
       background: var(--qwen-bg, rgba(28,28,30,0.7));
     }
     body {
@@ -16,6 +17,8 @@
       display: flex;
       flex-direction: column;
       gap: 0.75rem;
+      height: 100%;
+      overflow-y: auto;
     }
     .auto-toggle {
       display: flex;
diff --git a/src/popup/settings.html b/src/popup/settings.html
index aaef45c..5fc9fcf 100644
--- a/src/popup/settings.html
+++ b/src/popup/settings.html
@@ -5,13 +5,17 @@
   <link rel="stylesheet" href="../styles/apple.css">
   <link rel="stylesheet" href="../styles/cyberpunk.css">
   <style>
-    html { min-height: 100%; background: var(--qwen-bg, rgba(28,28,30,0.7)); }
+    html { height: 100%; background: var(--qwen-bg, rgba(28,28,30,0.7)); }
     body {
       font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
       margin: 0;
       padding: 1rem;
       color: var(--qwen-text, #f5f5f7);
-      width: 360px;
+      min-width: 260px;
+      max-width: 600px;
+      box-sizing: border-box;
+      height: 100%;
+      overflow-y: auto;
     }
     .tabs { display: flex; gap: 0.5rem; margin-bottom: 0.5rem; }
     .tabs button {
diff --git a/updates.xml b/updates.xml
index a18376e..b89271d 100644
--- a/updates.xml
+++ b/updates.xml
@@ -1,6 +1,6 @@
 <?xml version="1.0" encoding="UTF-8"?>
 <gupdate xmlns="http://www.google.com/update2/response" protocol="2.0">
   <app appid="YOUR_EXTENSION_ID">
-    <updatecheck codebase="https://raw.githubusercontent.com/MikkoParkkola/Qwen-translator-extension/main/qwen-translator-extension.crx" version="1.34.0" />
+    <updatecheck codebase="https://raw.githubusercontent.com/MikkoParkkola/Qwen-translator-extension/main/qwen-translator-extension.crx" version="1.42.0" />
   </app>
 </gupdate>
-- 
2.50.0

